<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Soft Deleting | Laratrust</title>
    <meta name="description" content="Laratrust is an easy and flexible way to add roles, permissions and teams authorization to your Laravel application">
    <link rel="icon" href="/favicon.ico">
  <meta name="robots" content="index, follow">
  <meta property="og:image" content="https://laratrust.santigarcor.me/logo.png">
  <meta property="og:description" content="Laratrust is an easy and flexible way to add roles, permissions and teams authorization to your Laravel application">
  <meta property="twitter:description" content="Laratrust is an easy and flexible way to add roles, permissions and teams authorization to your Laravel application">
        <link rel='canonical' href='https://laratrust.santigarcor.me/docs/6.x/usage/soft-deleting.html'/>

        <meta property="og:title" content='Soft Deleting | Laratrust'>
        <meta property="og:type" content="website">
        <meta property="og:url" content='https://laratrust.santigarcor.me/docs/6.x/usage/soft-deleting.html'>

        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content='Soft Deleting | Laratrust'>
      
    
    <link rel="preload" href="/assets/css/0.styles.68e00654.css" as="style"><link rel="preload" href="/assets/js/app.ee7036e2.js" as="script"><link rel="preload" href="/assets/js/84.958f4c5f.js" as="script"><link rel="prefetch" href="/assets/js/10.a5c81996.js"><link rel="prefetch" href="/assets/js/11.9b52799a.js"><link rel="prefetch" href="/assets/js/12.8cf46a2d.js"><link rel="prefetch" href="/assets/js/13.223879b8.js"><link rel="prefetch" href="/assets/js/14.f8a55da9.js"><link rel="prefetch" href="/assets/js/15.2598a0e0.js"><link rel="prefetch" href="/assets/js/16.c131fe17.js"><link rel="prefetch" href="/assets/js/17.0a27e3d8.js"><link rel="prefetch" href="/assets/js/18.60e10dc4.js"><link rel="prefetch" href="/assets/js/19.dae985ab.js"><link rel="prefetch" href="/assets/js/20.9919273b.js"><link rel="prefetch" href="/assets/js/21.0d334081.js"><link rel="prefetch" href="/assets/js/22.aaf1f2ac.js"><link rel="prefetch" href="/assets/js/23.06e4979b.js"><link rel="prefetch" href="/assets/js/24.dfb17a57.js"><link rel="prefetch" href="/assets/js/25.334b8584.js"><link rel="prefetch" href="/assets/js/26.7aa25a7a.js"><link rel="prefetch" href="/assets/js/27.2f7e800e.js"><link rel="prefetch" href="/assets/js/28.42a7a7a6.js"><link rel="prefetch" href="/assets/js/29.f7639850.js"><link rel="prefetch" href="/assets/js/3.e5000ba9.js"><link rel="prefetch" href="/assets/js/30.84ce1b34.js"><link rel="prefetch" href="/assets/js/31.188ae999.js"><link rel="prefetch" href="/assets/js/32.56bf4552.js"><link rel="prefetch" href="/assets/js/33.4e117ab8.js"><link rel="prefetch" href="/assets/js/34.6e21437a.js"><link rel="prefetch" href="/assets/js/35.e0f7e93b.js"><link rel="prefetch" href="/assets/js/36.9dc2747a.js"><link rel="prefetch" href="/assets/js/37.e3efe1a4.js"><link rel="prefetch" href="/assets/js/38.cf37a8ee.js"><link rel="prefetch" href="/assets/js/39.4d170df8.js"><link rel="prefetch" href="/assets/js/4.89f7539d.js"><link rel="prefetch" href="/assets/js/40.23803c65.js"><link rel="prefetch" href="/assets/js/41.a1cf9364.js"><link rel="prefetch" href="/assets/js/42.e4672c43.js"><link rel="prefetch" href="/assets/js/43.ee898fe7.js"><link rel="prefetch" href="/assets/js/44.25b18f03.js"><link rel="prefetch" href="/assets/js/45.328927d5.js"><link rel="prefetch" href="/assets/js/46.4d570b14.js"><link rel="prefetch" href="/assets/js/47.20ffe409.js"><link rel="prefetch" href="/assets/js/48.d5469779.js"><link rel="prefetch" href="/assets/js/49.fb70ef95.js"><link rel="prefetch" href="/assets/js/5.9738567a.js"><link rel="prefetch" href="/assets/js/50.f4d4f445.js"><link rel="prefetch" href="/assets/js/51.45b80187.js"><link rel="prefetch" href="/assets/js/52.52b8305f.js"><link rel="prefetch" href="/assets/js/53.ddaff0e2.js"><link rel="prefetch" href="/assets/js/54.5666fb0f.js"><link rel="prefetch" href="/assets/js/55.0398faca.js"><link rel="prefetch" href="/assets/js/56.aa1e2011.js"><link rel="prefetch" href="/assets/js/57.445fe0b6.js"><link rel="prefetch" href="/assets/js/58.4acaf767.js"><link rel="prefetch" href="/assets/js/59.e5ce359c.js"><link rel="prefetch" href="/assets/js/6.aaa94a46.js"><link rel="prefetch" href="/assets/js/60.fdf9769d.js"><link rel="prefetch" href="/assets/js/61.959d60a4.js"><link rel="prefetch" href="/assets/js/62.94928d4d.js"><link rel="prefetch" href="/assets/js/63.162324bc.js"><link rel="prefetch" href="/assets/js/64.b8be1919.js"><link rel="prefetch" href="/assets/js/65.02054c6e.js"><link rel="prefetch" href="/assets/js/66.02a32980.js"><link rel="prefetch" href="/assets/js/67.9950db60.js"><link rel="prefetch" href="/assets/js/68.6034f791.js"><link rel="prefetch" href="/assets/js/69.a297f698.js"><link rel="prefetch" href="/assets/js/7.e55d5ac8.js"><link rel="prefetch" href="/assets/js/70.25fc363d.js"><link rel="prefetch" href="/assets/js/71.50283243.js"><link rel="prefetch" href="/assets/js/72.3c78121e.js"><link rel="prefetch" href="/assets/js/73.40ffc0f5.js"><link rel="prefetch" href="/assets/js/74.56f84633.js"><link rel="prefetch" href="/assets/js/75.dc961211.js"><link rel="prefetch" href="/assets/js/76.71aa10f2.js"><link rel="prefetch" href="/assets/js/77.76847fc0.js"><link rel="prefetch" href="/assets/js/78.25e50d8e.js"><link rel="prefetch" href="/assets/js/79.62263c87.js"><link rel="prefetch" href="/assets/js/8.3f27e32e.js"><link rel="prefetch" href="/assets/js/80.75526165.js"><link rel="prefetch" href="/assets/js/81.1c9e5316.js"><link rel="prefetch" href="/assets/js/82.f66450ca.js"><link rel="prefetch" href="/assets/js/83.8b2bc8a5.js"><link rel="prefetch" href="/assets/js/85.a825d3c3.js"><link rel="prefetch" href="/assets/js/86.a9de1271.js"><link rel="prefetch" href="/assets/js/9.7a687b68.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.4e78967e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.68e00654.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Laratrust" class="logo"> <span class="site-name">Laratrust</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/6.x/" class="nav-link router-link-active">Docs</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/6.x/" class="nav-link router-link-active">6.x</a></li><li class="dropdown-item"><!----> <a href="/docs/5.2/" class="nav-link">5.2</a></li><li class="dropdown-item"><!----> <a href="/docs/5.1/" class="nav-link">5.1</a></li><li class="dropdown-item"><!----> <a href="/docs/5.0/" class="nav-link">5.0</a></li><li class="dropdown-item"><!----> <a href="https://laratrust.readthedocs.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  &lt;5.0
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/santigarcor/laratrust" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/6.x/" class="nav-link router-link-active">Docs</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/6.x/" class="nav-link router-link-active">6.x</a></li><li class="dropdown-item"><!----> <a href="/docs/5.2/" class="nav-link">5.2</a></li><li class="dropdown-item"><!----> <a href="/docs/5.1/" class="nav-link">5.1</a></li><li class="dropdown-item"><!----> <a href="/docs/5.0/" class="nav-link">5.0</a></li><li class="dropdown-item"><!----> <a href="https://laratrust.readthedocs.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  &lt;5.0
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/santigarcor/laratrust" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/docs/6.x/upgrade.html" class="sidebar-link">Upgrade from 5.2 to 6.X</a></li><li><a href="/docs/6.x/" class="sidebar-link">Introduction</a></li><li><a href="/docs/6.x/installation.html" class="sidebar-link">Installation</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>The basics</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Usage</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/docs/6.x/usage/roles-and-permissions.html" class="sidebar-link">Roles &amp; Permissions</a></li><li><a href="/docs/6.x/usage/querying-relationships.html" class="sidebar-link">Querying Relations</a></li><li><a href="/docs/6.x/usage/teams.html" class="sidebar-link">Teams</a></li><li><a href="/docs/6.x/usage/objects-ownership.html" class="sidebar-link">Objects Ownership</a></li><li><a href="/docs/6.x/usage/multiple-users.html" class="sidebar-link">Multiple User Models</a></li><li><a href="/docs/6.x/usage/events.html" class="sidebar-link">Events</a></li><li><a href="/docs/6.x/usage/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/docs/6.x/usage/soft-deleting.html" class="active sidebar-link">Soft Deleting</a></li><li><a href="/docs/6.x/usage/blade-templates.html" class="sidebar-link">Blade Templates</a></li><li><a href="/docs/6.x/usage/seeder.html" class="sidebar-link">Seeder</a></li><li><a href="/docs/6.x/usage/admin-panel.html" class="sidebar-link">Administration Panel</a></li></ul></div></li><li><a href="/docs/6.x/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li><li><a href="/docs/6.x/license.html" class="sidebar-link">License</a></li><li><a href="/docs/6.x/contributing.html" class="sidebar-link">Contributing</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="soft-deleting"><a href="#soft-deleting" class="header-anchor">#</a> Soft Deleting</h1> <p>The default migration takes advantage of <code>onDelete('cascade')</code> clauses within the pivot tables to remove relations when a parent record is deleted. If for some reason you can not use cascading deletes in your database, the LaratrustRole and LaratrustPermission classes, and the HasRole trait include event listeners to manually delete records in relevant pivot tables.</p> <p>In the interest of not accidentally deleting data, the event listeners will <strong>not</strong> delete pivot data if the model uses soft deleting. However, due to limitations in Laravel's event listeners, there is no way to distinguish between a call to <code>delete()</code> versus a call to <code>forceDelete()</code>. For this reason, <strong>before you force delete a model, you must manually delete any of the relationship data</strong> (unless your pivot tables uses cascading deletes). For example:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$role</span> <span class="token operator">=</span> Role<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">findOrFail</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Pull back a given role</span>

<span class="token comment">// Regular Delete</span>
<span class="token variable">$role</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This will work no matter what</span>

<span class="token comment">// Force Delete</span>
<span class="token variable">$role</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">users</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Delete relationship data</span>
<span class="token variable">$role</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">permissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Delete relationship data</span>

<span class="token variable">$role</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">forceDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now force delete will work regardless of whether the pivot table has cascading delete</span>
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/santigarcor/laratrust/edit/master/docs/docs/6.x/usage/soft-deleting.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">5/4/2020, 8:38:47 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/docs/6.x/usage/middleware.html" class="prev">
          Middleware
        </a></span> <span class="next"><a href="/docs/6.x/usage/blade-templates.html">
          Blade Templates
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.ee7036e2.js" defer></script><script src="/assets/js/84.958f4c5f.js" defer></script>
  </body>
</html>
